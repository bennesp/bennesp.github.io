<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>LDAP Setup | bennesp</title>
<meta name=keywords content="ldap,docker,authentication">
<meta name=description content="Why, what and how LDAP">
<meta name=author content="Me">
<link rel=canonical href=https://bennesp.github.io/posts/ldap-setup/>
<meta name=google-site-verification content="v7Xf_l3PpxLV6QMfXaclOrUym7CgrmzJEBFXrAzWnZ4">
<link crossorigin=anonymous href=/assets/css/stylesheet.min.e012190c622dd4890ec7d2d35a52674a545d936b7bfd85be1a6a4f4f50c0adca.css integrity="sha256-4BIZDGIt1IkOx9LTWlJnSlRdk2t7/YW+GmpPT1DArco=" rel="preload stylesheet" as=style>
<link rel=preload href=/imgs/bennesp.png as=image>
<link rel=icon href=https://bennesp.github.io/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=https://bennesp.github.io/favicon/favicon-16x16.png>
<link rel=icon type=image/png sizes=32x32 href=https://bennesp.github.io/favicon/favicon-32x32.png>
<link rel=apple-touch-icon href=https://bennesp.github.io/favicon/apple-touch-icon.png>
<link rel=mask-icon href=https://bennesp.github.io/favicon/apple-touch-icon.png>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<meta name=generator content="Hugo 0.89.4">
<noscript>
<style>#theme-toggle,.top-link{display:none}</style>
</noscript>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-189033864-1','auto'),ga('send','pageview'))</script><meta property="og:title" content="LDAP Setup">
<meta property="og:description" content="Why, what and how LDAP">
<meta property="og:type" content="article">
<meta property="og:url" content="https://bennesp.github.io/posts/ldap-setup/">
<meta property="og:image" content="https://bennesp.github.io/imgs/cover.png"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2021-11-24T19:08:07+01:00">
<meta property="article:modified_time" content="2021-11-24T19:08:07+01:00"><meta property="og:site_name" content="bennesp">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://bennesp.github.io/imgs/cover.png">
<meta name=twitter:title content="LDAP Setup">
<meta name=twitter:description content="Why, what and how LDAP">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://bennesp.github.io/posts/"},{"@type":"ListItem","position":2,"name":"LDAP Setup","item":"https://bennesp.github.io/posts/ldap-setup/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"LDAP Setup","name":"LDAP Setup","description":"Why, what and how LDAP","keywords":["ldap","docker","authentication"],"articleBody":"Snippets If you search only snippets, go to Snippets.\nWhy LDAP If you need to use LDAP, I’m really sorry, it simply sucks.\nIt is a very old idea with many limitations, but sadly still widely used.\nIf you search in Google Images or similar for “LDAP” you will only find interfaces that reminds me of Windows 95, like the following:\n A very old and ugly interface that I don’t want to see in my life\n  But as I previously said, it is just used a lot, so sooner or later we will have to face it.\nWhat is LDAP LDAP is a protocol to organize data in a hierarchical structure. Often these data are “users” and “organizations” of a company.\nAn implementation of ldap is openldap, and a convenient container image of openldap is osixia/openldap.\nHow LDAP Basic setup LDAP Server setup The simplest setup, using docker:\ndocker run --rm -ti -p 389:389 osixia/openldap:1.5.0 or using docker-compose:\nservices: ldap: image: osixia/openldap:1.5.0 ports: - \"389:389\" You can now play with it using a tool to manage the LDAP server.\nLDAP Client setup There are a lot of tools, but the only usable and not old style one that I found is jxplorer. It is written in Java so it is pretty portable. It has two “modes”: “HTML View” and “Table Editor”. “HTML View” is terrible, so I always use the “Table Editor”.\nIt looks like this:\n Jxplorer\n  You will want to login to the LDAP server. The “login” process in LDAP is called “binding” process. So you need to “bind” to the server.\nThe default credentials that the container image provides are currently:\nUser DN: cn=admin,dc=example,dc=com Password: admin  Login window\n  If they differ, refer to the documentation of the image on github.\ncn? dc? ou? In LDAP we refer to an object in a tree with its full “path”.\nSo cn=admin,dc=example,dc=org means “the object called cn=admin, inside the object called dc=example, which is inside the object called dc=org”\nWhy cn and dc?\nBecause objects are just a bunch of properties, and thus we need to define a property that identify the object. Why not using the same property for every object? Who knows.\nAnyway:\n dc (domain component) is used for directories cn (common name) is used for leaf nodes like users ou (organizational unit) is used for …yes, organizational unit  It is just convention.\nThis is an example of structure (with the first three nodes compressed):\n Example of structure\n  How to add an object? Since an object is just a bunch of properties inside a directory, we need to understand two things to add an object:\n What is the “path” of the object? What are the properties of the object?  Let’s suppose we want to create a top-level organizational unit, for example we want to add the organizational unitfor the “Quality” department of our company that is called example.org.\nWe will create the object:\n Inside dc=example,dc=org, so that it will be ou=Quality,dc=example,dc=org With the properties that an organizational unit should have  Properties are defined in groups by “objectClasses”. Each object class has a name and a collection of properties.\nIf we try to create a new node, and search inside the available object classes, we can find the organizationalUnit:\n objectClasses\n  Adding it and submitting the final object, will lead to a new object in the directory structure\n Quality organizational unit added\n  CLI ftw… or wtf Personally I really like UIs since they make it easier to understand what is going on, but when automation is needed, the CLI is the obvious best option.\nBut, as I previously told, LDAP is old AF. So CLI is terrible.\nThese are some tools (pre-installed on osx):\nldapadd ldapdelete ldapmodify ldappasswd ldapurl ldapcompare ldapexop ldapmodrdn ldapsearch ldapwhoami slapacl slapauth slapconfig slapindex slapschema slapadd slapcat slapdn slappasswd slaptest Yes, they are a lot, but the most useful are ldapadd and ldapsearch\n","wordCount":"646","inLanguage":"en","image":"https://bennesp.github.io/imgs/cover.png","datePublished":"2021-11-24T19:08:07+01:00","dateModified":"2021-11-24T19:08:07+01:00","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://bennesp.github.io/posts/ldap-setup/"},"publisher":{"@type":"Organization","name":"bennesp","logo":{"@type":"ImageObject","url":"https://bennesp.github.io/favicon.ico"}}}</script>
</head>
<body class=dark id=top>
<script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove('dark')</script>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=https://bennesp.github.io/ accesskey=h title="bennesp (Alt + H)">
<img src=/imgs/bennesp.png alt=logo aria-label=logo height=32>bennesp</a>
<span class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</span>
</div>
<ul id=menu>
<li>
<a href=https://bennesp.github.io/search/ title="search (Alt + /)" accesskey=/>
<span>search</span>
</a>
</li>
<li>
<a href=https://bennesp.github.io/tags/ title=tags>
<span>tags</span>
</a>
</li>
</ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<div class=breadcrumbs><a href=https://bennesp.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://bennesp.github.io/posts/>Posts</a></div>
<h1 class=post-title>
LDAP Setup
</h1>
<div class=post-meta><span title="2021-11-24 19:08:07 +0100 CET">24 November 2021</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;Me&nbsp;|&nbsp;<a href=https://github.com/bennesp/bennesp.github.io/blob/master/content/posts/001-ldap/index.md rel="noopener noreferrer" target=_blank>Suggest Changes</a>
</div>
</header>
<div class=post-content><h1 id=snippets>Snippets<a hidden class=anchor aria-hidden=true href=#snippets>#</a></h1>
<p>If you search only snippets, go to <a href=https://bennesp.github.io/posts/ldap-snippets/>Snippets</a>.</p>
<h1 id=why-ldap>Why LDAP<a hidden class=anchor aria-hidden=true href=#why-ldap>#</a></h1>
<p>If you need to use LDAP, I&rsquo;m really sorry, it simply sucks.</p>
<p>It is a <strong>very old</strong> idea with many limitations, but sadly still widely used.</p>
<p>If you search in Google Images or similar for &ldquo;LDAP&rdquo; you will only find
interfaces that reminds me of Windows 95, like the following:</p>
<figure class=align-center>
<img loading=lazy src=imgs/ldap_windows95_style.jpg#center alt="A very old and ugly interface that I don&amp;rsquo;t want to see in my life"> <figcaption>
<p>A very old and ugly interface that I don&rsquo;t want to see in my life</p>
</figcaption>
</figure>
<p>But as I previously said, it is just used a lot, so sooner or later we will have
to face it.</p>
<h1 id=what-is-ldap>What is LDAP<a hidden class=anchor aria-hidden=true href=#what-is-ldap>#</a></h1>
<p>LDAP is a protocol to organize data in a hierarchical structure.
Often these data are &ldquo;users&rdquo; and &ldquo;organizations&rdquo; of a company.</p>
<p>An implementation of ldap is <code>openldap</code>, and a convenient container image of
openldap is <a href=https://hub.docker.com/r/osixia/openldap/><code>osixia/openldap</code></a>.</p>
<h1 id=how-ldap>How LDAP<a hidden class=anchor aria-hidden=true href=#how-ldap>#</a></h1>
<h2 id=basic-setup>Basic setup<a hidden class=anchor aria-hidden=true href=#basic-setup>#</a></h2>
<h3 id=ldap-server-setup>LDAP Server setup<a hidden class=anchor aria-hidden=true href=#ldap-server-setup>#</a></h3>
<p>The simplest setup, using docker:</p>
<div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-sh data-lang=sh>docker run --rm -ti -p 389:389 osixia/openldap:1.5.0
</code></pre></div><p>or using <code>docker-compose</code>:</p>
<div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=color:#268bd2>services</span>:
  <span style=color:#268bd2>ldap</span>:
    <span style=color:#268bd2>image</span>: osixia/openldap:1.5.0
    <span style=color:#268bd2>ports</span>:
      - <span style=color:#2aa198>&#34;389:389&#34;</span>
</code></pre></div><p>You can now play with it using a tool to manage the LDAP server.</p>
<h3 id=ldap-client-setup>LDAP Client setup<a hidden class=anchor aria-hidden=true href=#ldap-client-setup>#</a></h3>
<p>There are a lot of tools, but the only usable and not old style one that I found
is <a href=http://jxplorer.org/downloads/users.html>jxplorer</a>.
It is written in Java so it is pretty portable.
It has two &ldquo;modes&rdquo;: &ldquo;HTML View&rdquo; and &ldquo;Table Editor&rdquo;. &ldquo;HTML View&rdquo; is terrible, so
I always use the &ldquo;Table Editor&rdquo;.</p>
<p>It looks like this:</p>
<figure class=align-center>
<img loading=lazy src=imgs/jxplorer.png#center alt=Jxplorer> <figcaption>
<p>Jxplorer</p>
</figcaption>
</figure>
<p>You will want to login to the LDAP server. The &ldquo;login&rdquo; process in LDAP is called
&ldquo;binding&rdquo; process. So you need to &ldquo;bind&rdquo; to the server.</p>
<p>The default credentials that the container image provides are currently:</p>
<div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=color:#268bd2>User DN</span>:    cn=admin,dc=example,dc=com
<span style=color:#268bd2>Password</span>:   admin
</code></pre></div><figure class=align-center>
<img loading=lazy src=imgs/login.png#center alt="Login window"> <figcaption>
<p>Login window</p>
</figcaption>
</figure>
<p>If they differ, refer to the <a href=https://github.com/osixia/docker-openldap>documentation of the image on github</a>.</p>
<h2 id=cn-dc-ou>cn? dc? ou?<a hidden class=anchor aria-hidden=true href=#cn-dc-ou>#</a></h2>
<p>In LDAP we refer to an object in a tree with its full &ldquo;path&rdquo;.</p>
<p>So <code>cn=admin,dc=example,dc=org</code> means &ldquo;the object called <code>cn=admin</code>, inside the
object called <code>dc=example</code>, which is inside the object called <code>dc=org</code>&rdquo;</p>
<p>Why <code>cn</code> and <code>dc</code>?</p>
<p>Because objects are just a bunch of properties, and thus we need to define a
property that identify the object. Why not using the same property for every
object? Who knows.</p>
<p>Anyway:</p>
<ul>
<li><code>dc</code> (domain component) is used for directories</li>
<li><code>cn</code> (common name) is used for leaf nodes like users</li>
<li><code>ou</code> (organizational unit) is used for &mldr;yes, organizational unit</li>
</ul>
<p>It is just convention.</p>
<p>This is an example of structure (with the first three nodes compressed):</p>
<figure class=align-center>
<img loading=lazy src=imgs/cover.png#center alt="Example of structure"> <figcaption>
<p>Example of structure</p>
</figcaption>
</figure>
<h2 id=how-to-add-an-object>How to add an object?<a hidden class=anchor aria-hidden=true href=#how-to-add-an-object>#</a></h2>
<p>Since an object is just a bunch of properties inside a directory, we need to
understand two things to add an object:</p>
<ol>
<li>What is the &ldquo;path&rdquo; of the object?</li>
<li>What are the properties of the object?</li>
</ol>
<p>Let&rsquo;s suppose we want to create a top-level organizational unit, for
example we want to add the organizational unitfor the &ldquo;Quality&rdquo; department of
our company that is called example.org.</p>
<p>We will create the object:</p>
<ol>
<li>Inside <code>dc=example,dc=org</code>, so that it will be <code>ou=Quality,dc=example,dc=org</code></li>
<li>With the properties that an organizational unit should have</li>
</ol>
<p>Properties are defined in groups by &ldquo;objectClasses&rdquo;. Each object class has a
name and a collection of properties.</p>
<p>If we try to create a new node, and search inside the available object classes,
we can find the organizationalUnit:</p>
<figure class=align-center>
<img loading=lazy src=imgs/ou1.png#center alt=objectClasses> <figcaption>
<p>objectClasses</p>
</figcaption>
</figure>
<p>Adding it and submitting the final object, will lead to a new object in the
directory structure</p>
<figure class=align-center>
<img loading=lazy src=imgs/ou2.png#center alt="Quality organizational unit added"> <figcaption>
<p>Quality organizational unit added</p>
</figcaption>
</figure>
<h2 id=cli-ftw-or-wtf>CLI ftw&mldr; or wtf<a hidden class=anchor aria-hidden=true href=#cli-ftw-or-wtf>#</a></h2>
<p>Personally I really like UIs since they make it easier to understand what is
going on, but when automation is needed, the CLI is the obvious best option.</p>
<p>But, as I previously told, LDAP is old AF. So CLI is terrible.</p>
<p>These are some tools (pre-installed on osx):</p>
<div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback>ldapadd      ldapdelete   ldapmodify   ldappasswd   ldapurl
ldapcompare  ldapexop     ldapmodrdn   ldapsearch   ldapwhoami
slapacl      slapauth     slapconfig   slapindex    slapschema
slapadd      slapcat      slapdn       slappasswd   slaptest
</code></pre></div><p>Yes, they are a lot, but the most useful are <code>ldapadd</code> and <code>ldapsearch</code></p>
</div>
<footer class=post-footer>
<ul class=post-tags>
<li><a href=https://bennesp.github.io/tags/ldap/>ldap</a></li>
<li><a href=https://bennesp.github.io/tags/docker/>docker</a></li>
<li><a href=https://bennesp.github.io/tags/authentication/>authentication</a></li>
</ul>
<nav class=paginav>
<a class=prev href=https://bennesp.github.io/posts/ldap-snippets/>
<span class=title>« Prev Page</span>
<br>
<span>LDAP Snippets</span>
</a>
</nav>
</footer>
</article>
</main>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><footer class=footer>
© 2021 <a href=https://bennesp.github.io/>bennesp</a>
</footer>
<script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script>
<script>document.querySelectorAll('pre > code').forEach(b=>{const c=b.parentNode.parentNode,a=document.createElement('button');a.classList.add('copy-code'),a.innerText='copy';function d(){a.innerText='copied!',setTimeout(()=>{a.innerText='copy'},2e3)}a.addEventListener('click',e=>{if('clipboard'in navigator){navigator.clipboard.writeText(b.textContent),d();return}const a=document.createRange();a.selectNodeContents(b);const c=window.getSelection();c.removeAllRanges(),c.addRange(a);try{document.execCommand('copy'),d()}catch(a){}c.removeRange(a)}),c.classList.contains("highlight")?c.appendChild(a):c.parentNode.firstChild==c||(b.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?b.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(a):b.parentNode.appendChild(a))})</script>
</body>
</html>